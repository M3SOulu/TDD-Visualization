<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Zorro Episode Visualization</title>
        <style>
            .axis path,
            .axis line {
               fill: none;
               stroke: red;
               shape-rendering: crispEdges;
            }

            .axis text {
                font-family: sans-serif;
                font-size: 11px;
            } 
        </style>
            <script src="//d3js.org/d3.v3.min.js" charset="utf-8"></script>
            <script src="d3.legend.js"></script>
    </head>
    <body>  
        <script type="text/javascript">
            var dataset = [ [5,"testLast"], [10,"testFirst"], [15,"testAddition"], [20,"testLast"], [21,"codeProduction"], [25,"refactor"], [26,"testLast"], 
        [28,"codeProduction"], [30,"testLast"], [31,"refactor"],[32,"regression"], [34,"refactor"], [38,"regression"], [40,"testFirst"], [42,"testLast"], 
        [45,"testAddition"], [46,"refactor"], [47,"codeProduction"],[49,"refactor"], [50,"testFirst"] ];
            var informations = [["Data Coverage: 58.76%",1],["Number of actions: 30",2],["Time Taken: 600 sec",3],["Passing Tests: 10",4],["Failing Tests: 0",5]];
            var svgHeigth = 400;
            var svgWidth = 1000;
            var padding = 30;
            var previousWidth = 0;
            var barPadding = 40;
            var svg = d3.select("body")
                        .append("svg")
                        .attr("width", svgWidth)
                        .attr("height", svgHeigth);
            var svgInfo = d3.select("body")
                        .append("svg")
                        .attr("width", svgWidth - 300)
                        .attr("height", svgHeigth);
            var legend = d3.select("body")                            
                            .append("svg")
                            .attr("width", svgWidth - 500)
                            .attr("height", svgHeigth);
            var xScale = d3.scale.linear()
                           .domain([0,240])
                           .range([5,965]);
            var yScale = d3.scale.linear()
                           .domain([100,0])
                           .range([0, 360]);                          
            var xAxis =  d3.svg.axis()
                           .scale(xScale)
                           .orient("bottom")
                           .ticks(20);
            var yAxis = d3.svg.axis()
                            .scale(yScale)
                            .orient("left")
                            .ticks(20);
            svg.append("g")
               .attr("class", "axis")
               .attr("transform", "translate(25," + (svgHeigth - padding + 5 ) + ")")
               .call(xAxis);
               //.text("loistavaa")
            svg.append("g")
               .attr("class", "axis")
               .attr("transform", "translate(" + padding + ",14)")
               .call(yAxis);
            svg.selectAll("rect")
                .data(dataset)
                .enter()
                .append("rect")
                .attr("x", function(d, i) {
                      return i * (svgWidth / dataset.length) + 30.5;  
                })
                .attr("y", function(d) {
                    return svgHeigth - d[0] *6 -25.3;  //Height minus data value
                })
                .attr("width", svgWidth / dataset.length - barPadding)
                .attr("height", function(d) {
                    return d[0] * 6;
                })
                .attr("fill", function(d) {
                    if (d[1] === "testLast")
                        {
                        color = "rgb(204,0,0)";    
                        return "rgb(204, 0, 0)";
                        }
                    else if(d[1] === "testFirst")
                    {                        
                        color = "rgb(0, 204, 0)";
                        return "rgb(0, 204, 0)";
                    }
                    else if(d[1] === "testAddition")
                        return "rgb(204, 0, 204)";
                    else if(d[1] === "regression")
                        return "rgb(204, 204, 0)";
                    else if(d[1] === "codeProduction")
                        return "rgb(204, 102, 0)";
                    else
                        return "rgb(0, 0, 204)";
                })
                .on("click", function() {
                      svgInfo.selectAll("text")
                             .append("text")
                             .text(function(d) {
                                return d[1];
                             })
                             .attr("y", function(d){
                                return d[1] * 70;
                             })
                             .attr("x", 300)
                             .style("font-size","25px");
                });
                svg.selectAll("text")
                   .data(dataset)
                   .enter()
                   .append("text")
                   .text(function(d) {
                        return d;
                   })
                   .attr("x", function(d, i) {
                        return i * (w / dataset.length);
                    })
                    .attr("y", function(d) {
                        return h - (d * 4);
                    });
            svgInfo.selectAll("text")
                .data(informations)
                .enter()
                .append("text")
                .text(function(d) {
                    return d[0];
                })
                .attr("y", function(d){
                    return d[1] * 70;
                })
                .style("font-size","25px");
             // draw legend colored rectangles
           legend.selectAll('rect')
                 .data(dataset)
                 .enter()
                 .append("rect")
                 .attr("x", svgWidth - 965)
                 .attr("y", function(d) {
                    if (d[1] === "testLast")
                          return 10;
                    else if(d[1] === "testFirst")
                          return 45;
                    else if(d[1] === "testAddition")
                        return 80;
                    else if(d[1] === "regression")
                        return 115;
                    else if(d[1] === "codeProduction")
                        return 150;
                    else
                        return 185;
                })
                 .attr("width", 30)
                 .attr("height", 30)
                 .style("fill", function(d) {
                    if (d[1] === "testLast")
                        {
                        color = "rgb(204,0,0)";    
                        return "rgb(204, 0, 0)";
                        }
                    else if(d[1] === "testFirst")
                    {                        
                        color = "rgb(0, 204, 0)";
                        return "rgb(0, 204, 0)";
                    }
                    else if(d[1] === "testAddition")
                        return "rgb(204, 0, 204)";
                    else if(d[1] === "regression")
                        return "rgb(204, 204, 0)";
                    else if(d[1] === "codeProduction")
                        return "rgb(204, 102, 0)";
                    else
                        return "rgb(0, 0, 204)";
                });
            legend.selectAll('text')
                 .data(dataset)
                 .enter()
                 .append("text")
                 .text(function(d) 
                 {
                     return d[1];
                 })
                 .attr("x",100)
                 .attr("y", function(d) {
                    if (d[1] === "testLast")
                          return 30;
                    else if(d[1] === "testFirst")
                          return 65;
                    else if(d[1] === "testAddition")
                        return 100;
                    else if(d[1] === "regression")
                        return 135;
                    else if(d[1] === "codeProduction")
                        return 170;
                    else
                        return 205;
                })
                .style("font-size","25px");
        </script>
    </body>
</html>
